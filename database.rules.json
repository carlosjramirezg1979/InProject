{
  "rules": {
    // Los perfiles de usuario solo son legibles y escribibles por el propio usuario.
    "projectManagers": {
      "$uid": {
        ".read": "auth != null && auth.uid === $uid",
        ".write": "auth != null && auth.uid === $uid"
      }
    },
    // Los datos de las empresas son legibles por los usuarios que pertenecen a ellas.
    "companies": {
      "$companyId": {
        ".read": "auth != null && root.child('projectManagers').child(auth.uid).child('companyIds').child($companyId).exists()",
        // La escritura/modificación se deja restringida por ahora. 
        // Se podría permitir al 'ownerId' o a un admin.
        ".write": false 
      }
    },
    // Los proyectos son legibles por los usuarios que pertenecen a la empresa del proyecto.
    "projects": {
      "$projectId": {
        ".read": "auth != null && root.child('projectManagers').child(auth.uid).child('companyIds').child(data.child('companyId').val()).exists()",
         // La escritura/modificación se deja restringida.
        ".write": false
      }
    },
    // Por defecto, se deniega el acceso de lectura y escritura a toda la base de datos.
    ".read": false,
    ".write": false
  }
}
